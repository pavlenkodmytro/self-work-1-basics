"""
Головна програма для запуску всіх завдань самостійної роботи №1

Ця програма об'єднує всі п'ять завдань у єдине меню:
- Завдання 1: Програма-анкета (16 питань)
- Завдання 2: Розрахунок значення Z за формулою
- Завдання 3: Обчислення функції f(x)
- Завдання 4: Фільтрація чисел за інтервалом
- Завдання 5: Пошук мінімуму/максимуму за парністю

Автор: Павленко Дмитро
Група: ІСД-31
Спеціальність: 126
Університет: ДУІКТ
"""

# Імпортуємо головні функції з кожного модуля завдань
from task1_survey import run_survey
from task2_calculation_z import run_calculation
from task3_function import run_function_calculation
from task4_interval import run_interval_filtering
from task5_min_max import run_min_max_finder


def display_main_menu():
    """
    Виводить головне меню програми з переліком всіх доступних завдань.
    """
    print()
    print("=" * 80)
    print("САМОСТІЙНА РОБОТА №1 - ОСНОВИ ПРОГРАМУВАННЯ PYTHON")
    print("=" * 80)
    print()
    print("Доступні завдання:")
    print()
    print("  1 - Завдання 1: Програма-анкета студента (16 питань)")
    print("  2 - Завдання 2: Розрахунок Z = (9πt + 10) / √(t - |x|)")
    print("  3 - Завдання 3: Обчислення функції f(x) = x² + 2x - 5")
    print("  4 - Завдання 4: Фільтрація трьох чисел за інтервалом [1, N]")
    print("  5 - Завдання 5: Пошук мін/макс залежно від парності числа")
    print()
    print("  0 - Вийти з програми")
    print()
    print("=" * 80)


def run_task_by_choice(choice):
    """
    Запускає обране користувачем завдання.

    Args:
        choice (str): Вибір користувача (номер завдання від 1 до 5)

    Returns:
        bool: True якщо програма має продовжувати роботу,
              False якщо користувач обрав вихід
    """
    print()

    if choice == '1':
        # Запуск завдання 1: Програма-анкета
        print("Запуск Завдання 1: Програма-анкета")
        print("=" * 80)
        run_survey()

    elif choice == '2':
        # Запуск завдання 2: Розрахунок Z
        print("Запуск Завдання 2: Розрахунок значення Z")
        print("=" * 80)
        run_calculation()

    elif choice == '3':
        # Запуск завдання 3: Обчислення функції
        print("Запуск Завдання 3: Обчислення функції")
        print("=" * 80)
        run_function_calculation()

    elif choice == '4':
        # Запуск завдання 4: Фільтрація за інтервалом
        print("Запуск Завдання 4: Фільтрація за інтервалом")
        print("=" * 80)
        run_interval_filtering()

    elif choice == '5':
        # Запуск завдання 5: Пошук мін/макс
        print("Запуск Завдання 5: Пошук мінімуму/максимуму")
        print("=" * 80)
        run_min_max_finder()

    elif choice == '0':
        # Вихід з програми
        print("=" * 80)
        print("Завершення роботи програми. До побачення!")
        print("=" * 80)
        return False

    else:
        # Некоректний вибір
        print("=" * 80)
        print("ПОМИЛКА: Некоректний вибір!")
        print("Будь ласка, оберіть номер від 0 до 5")
        print("=" * 80)

    return True


def main():
    """
    Головна функція програми з інтерактивним меню.

    Запускає нескінченний цикл, який:
    1. Виводить меню з доступними завданнями
    2. Запитує вибір користувача
    3. Виконує обране завдання
    4. Повертається до меню (або завершує програму при виборі 0)
    """
    # Виводимо привітання при запуску програми
    print()
    print("╔" + "=" * 78 + "╗")
    print("║" + " " * 78 + "║")
    print("║" + "   САМОСТІЙНА РОБОТА №1 - ОСНОВИ ПРОГРАМУВАННЯ PYTHON".center(78) + "║")
    print("║" + " " * 78 + "║")
    print("║" + "   Автор: Павленко Дмитро".center(78) + "║")
    print("║" + "   Спеціальність: 126".center(78) + "║")
    print("║" + "   Університет: ДУІКТ".center(78) + "║")
    print("║" + " " * 78 + "║")
    print("╚" + "=" * 78 + "╝")

    # Основний цикл програми
    continue_program = True
    while continue_program:
        # Виводимо меню
        display_main_menu()

        # Запитуємо вибір користувача
        user_choice = input("Ваш вибір: ").strip()

        # Виконуємо обране завдання
        continue_program = run_task_by_choice(user_choice)

        # Якщо програма продовжує роботу, пропонуємо повернутися до меню
        if continue_program:
            print()
            input("Натисніть Enter, щоб повернутися до головного меню...")


# Точка входу в програму
# Цей блок виконається тільки якщо файл запущено безпосередньо,
# а не імпортовано як модуль
if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        # Обробка переривання програми (Ctrl+C)
        print()
        print()
        print("=" * 80)
        print("Програму перервано користувачем. До побачення!")
        print("=" * 80)
    except Exception as error:
        # Обробка несподіваних помилок
        print()
        print("=" * 80)
        print("КРИТИЧНА ПОМИЛКА")
        print("=" * 80)
        print(f"Виникла несподівана помилка: {str(error)}")
        print("Будь ласка, зверніться до розробника.")
        print("=" * 80)
